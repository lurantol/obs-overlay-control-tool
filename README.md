# OBS Overlay Control Tool

Инструмент для управления текстовыми оверлеями OBS на танцевальных фестивалях
(West Coast Swing и аналогичные форматы).

---

## Назначение

Приложение предназначено для оператора трансляции и решает задачу
быстрого, безопасного и структурированного вывода текстовой информации в OBS:

- текущая номинация в эфире;
- текущая пара (для финалов);
- отборы / prelims / semis с Heat’ами;
- анонс следующего дивизиона (NEXT);
- показательные выступления (Special / Show / Formation);
- работа с реальными списками участников из CSV / Excel.

Приложение работает **локально**, без интернета, и управляет OBS через
текстовые файлы.

---

## Как это работает (общая схема)

1. Приложение запускается на ноутбуке оператора.
2. Управление осуществляется через браузер (Mac / iPad).
3. Приложение записывает текст в файлы.
4. OBS читает эти файлы через `Text (from file)` и автоматически обновляет эфир.

Связь с OBS осуществляется **только через файлы**, без WebSocket и плагинов,
что обеспечивает максимальную надёжность в эфире.

---

## Источники в OBS

Необходимо создать 3 текстовых источника:

- `out/current_title.txt` — что сейчас в эфире
- `out/current_pair.txt` — текущая пара или название номера
- `out/next_title.txt` — следующий дивизион (NEXT)

### Browser Source вместо Text Source (рекомендуется)

Если OBS периодически "съедает" символы при обновлении Text Source из файла, можно уйти на **Browser Source**.

Приложение отдаёт готовую страницу-оверлей:

- Current (title + pair):
  - `http://127.0.0.1:3000/overlay.html?mode=current`
- Next (только заголовок NEXT):
  - `http://127.0.0.1:3000/overlay.html?mode=next`

Параметры:
- `interval=300` — частота опроса (мс)
- `hideEmpty=1` — скрывать пустые строки (0/1)
- `titleSize=48px` / `pairSize=40px` — размеры текста

---

## Вкладка «Эфир»

Основная рабочая панель оператора.

### Финалы
Используется для конкурсов с парами:
- выбор номинации;
- выбор любых двух участников;
- кнопка «Применить в эфир».

Результат:
- `current_title` — название финала;
- `current_pair` — «Имя — Имя».

Heat’ы отсутствуют.

---

### Отборы
Используется для prelims / semis:
- выбор номинации;
- выбор Heat кнопками;
- кнопка «Применить в эфир».

Результат:
- `current_title` — «Номинация • Heat X»;
- `current_pair` очищается.

---

### NEXT
Отдельный режим анонса:
- выбор следующей номинации;
- Heat — только для отборов;
- кнопка «Применить NEXT».

Результат:
- `next_title` — «NEXT: …».

---

### Special
Используется для показательных и шоу-выступлений:
- ProShow;
- Team Show;
- Formation;
- Guest Performance и т.п.

Логика:
- выбирается тип Special;
- выбирается участник/команда из списка, который задан в админке;
- кнопка «Применить в эфир».

Результат:
- `current_title` — тип выступления;
- `current_pair` — выбранный участник/команда.

---

## Вкладка «Админ»

Раздел подготовки и настройки.

### Номинации
- добавление финалов и отборов;
- указание типа (финалы / отборы);
- ограничение списка участников для конкретной номинации;
- настройка кнопок Heat.

---

### Special
Каталог типов показательных выступлений:
- добавление / редактирование типов (ProShow, Team Show и т.д.);
 - для каждого типа задаётся список строк (каждая строка — участник/пара/команда);
 - этот список потом используется во втором выпадающем списке во вкладке «Эфир → Special».
- используется в Эфире → Special.

---

### Импорт
Импорт участников из CSV / XLS / XLSX:

1. Загрузка файла.
2. Просмотр заголовков.
3. Выбор колонки с номером и колонки с именем.
4. Импорт данных.

Роли назначаются автоматически:
- нечётный номер → lead;
- чётный номер → follow.

Роль не ограничивает выбор в финалах.

---

## Запуск

### Требования
- macOS
- Node.js 18+
- OBS Studio

### Установка
```
npm install
```

### Запуск
```
npm start
```

### Открытие интерфейса
- Mac: http://localhost:3000
- iPad / другое устройство: http://IP_Мака:3000

---

## Почему такая архитектура

- файлы вместо WebSocket — максимальная стабильность;
- локальный сервер — независимость от интернета;
- чёткое разделение режимов;
- минимизация ошибок в эфире;
- подходит под реальные фестивальные сценарии.

---

## Целевая аудитория

- операторы OBS;
- медиакоманды танцевальных фестивалей;
- организаторы соревнований;
- ситуации с высокой нагрузкой и ответственностью за эфир.
